dc={version:"0.1.0",_charts:[]},dc.registerChart=function(e){dc._charts.push(e)},dc.hasChart=function(e){return dc._charts.indexOf(e)>=0},dc.removeAllCharts=function(){dc._charts=[]},dc.filterAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].filterAll()},dc.renderAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].render()},dc.pieChart=function(e){var t=null,n="pie-slice",r,i,s=d3.scale.category20c(),o,u,a=0,f=0,l=0,c=0,h=t,p={};return p.render=function(){i.select("svg").remove();if(p.dataAreSet()){var e=p.generateTopLevelG(),t=d3.layout.pie().value(function(e){return e.value}),n=p.buildArcs(),r=p.drawSlices(e,t,n);p.drawLabels(r,n),p.highlightFilter()}},p.select=function(e){return i.select(e)},p.selectAll=function(e){return i.selectAll(e)},p.anchor=function(e){return arguments.length?(r=e,i=d3.select(r),p):r},p.innerRadius=function(e){return arguments.length?(c=e,p):c},p.colors=function(e){return arguments.length?(s=e,p):s},p.dimension=function(e){return arguments.length?(o=e,p):o},p.group=function(e){return arguments.length?(u=e,p):u},p.filter=function(e){return o.filter(e),p},p.width=function(e){return arguments.length?(a=e,p):a},p.height=function(e){return arguments.length?(f=e,p):f},p.radius=function(e){return arguments.length?(l=e,p):l},p.filter=function(e){return arguments.length?(h=e,p.highlightFilter(),p.dataAreSet()&&o.filter(h),p):h},p.filterAll=function(){return p.filter(t)},p.hasFilter=function(){return h!=t},p.generateTopLevelG=function(){return i.append("svg").data([u.all()]).attr("width",a).attr("height",f).append("g").attr("transform","translate("+p.cx()+","+p.cy()+")")},p.cx=function(){return a/2},p.cy=function(){return f/2},p.buildArcs=function(){return d3.svg.arc().outerRadius(l).innerRadius(c)},p.drawSlices=function(e,t,r){var i=e.selectAll("g."+n).data(t).enter().append("g").attr("class",n);return i.append("path").attr("fill",function(e,t){return s(t)}).attr("d",r).on("click",function(e){p.filter(e.data.key),dc.renderAll()}),i},p.drawLabels=function(e,t){e.append("text").attr("transform",function(e){e.innerRadius=0,e.outerRadius=l;var n=t.centroid(e);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(e){var t=e.data;return t.value==0?"":t.key})},p.isSelectedSlice=function(e){return h==e.data.key},p.highlightFilter=function(){h&&i.selectAll("g."+n).select("path").each(function(e){p.isSelectedSlice(e)?d3.select(this).attr("fill-opacity",1).attr("stroke","#ccc").attr("stroke-width",3):d3.select(this).attr("fill-opacity",.1).attr("stroke-width",0)})},p.dataAreSet=function(){return o!=undefined&&u!=undefined},dc.registerChart(p),p.anchor(e)};