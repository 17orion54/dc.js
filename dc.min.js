dc={version:"0.2.0",_charts:[]},dc.registerChart=function(e){dc._charts.push(e)},dc.hasChart=function(e){return dc._charts.indexOf(e)>=0},dc.deregisterAllCharts=function(){dc._charts=[]},dc.filterAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].filterAll()},dc.renderAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].render()},dc.redrawAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].redraw()},dc.transition=function(e,t,n){if(t<=0)return e;var r=e.transition().duration(t);return n instanceof Function&&n(r),r},dc.units={},dc.units.integers=function(e,t){return new Array(Math.abs(t-e))},dc.round={},dc.round.floor=function(e){return Math.floor(e)},dc.baseChart=function(e){var t,n,r,i,s=200,o=200,u=750;return e.dimension=function(n){return arguments.length?(t=n,e):t},e.group=function(t){return arguments.length?(n=t,e):n},e.orderedGroup=function(){return n.order(function(e){return e.key})},e.filterAll=function(){return e.filter(null)},e.dataAreSet=function(){return t!=undefined&&n!=undefined},e.select=function(e){return i.select(e)},e.selectAll=function(e){return i.selectAll(e)},e.anchor=function(t){return arguments.length?(r=t,i=d3.select(r),e):r},e.root=function(t){return arguments.length?(i=t,e):i},e.width=function(t){return arguments.length?(s=t,e):s},e.height=function(t){return arguments.length?(o=t,e):o},e.resetSvg=function(){e.select("svg").remove()},e.generateSvg=function(){return e.root().append("svg").data([e.group().top(Infinity)]).attr("width",e.width()).attr("height",e.height())},e.turnOnReset=function(){e.select("a.reset").style("display",null)},e.turnOffReset=function(){e.select("a.reset").style("display","none")},e.transitionDuration=function(t){return arguments.length?(u=t,e):u},e.filter=function(t){return e},e.render=function(){return e},e.redraw=function(){return e},e},dc.coordinateGridChart=function(e){e=dc.baseChart(e);var t={top:10,right:50,bottom:30,left:20};return e.margins=function(n){return arguments.length?(t=n,e):t},e},dc.pieChart=function(e){function d(){return d3.layout.pie().value(function(e){return e.value})}function v(e){dc.transition(c,h.transitionDuration()).attr("transform",function(t){t.innerRadius=h.innerRadius(),t.outerRadius=i;var n=e.centroid(t);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(e){var t=e.data;return t.value==0?"":p(e)})}function m(e){e.innerRadius=h.innerRadius();var t=this._current;g(t)&&(t={startAngle:0,endAngle:0});var n=d3.interpolate(t,e);return this._current=n(0),function(e){return u(n(e))}}function g(e){return e==null||isNaN(e.startAngle)||isNaN(e.endAngle)}function y(e){h.filter(e.data.key),dc.redrawAll()}var t,n="pie-slice",r=d3.scale.category20c(),i=0,s=0,o,u,a,f,l,c,h=dc.baseChart({}),p=function(e){return e.data.key};return h.transitionDuration(350),h.render=function(){return h.resetSvg(),h.dataAreSet()&&(o=h.generateSvg().append("g").attr("transform","translate("+h.cx()+","+h.cy()+")"),a=d(),u=h.buildArcs(),f=h.drawSlices(o,a,u),h.drawLabels(f,u),h.highlightFilter()),h},h.innerRadius=function(e){return arguments.length?(s=e,h):s},h.colors=function(e){return arguments.length?(r=d3.scale.ordinal().range(e),h):r},h.radius=function(e){return arguments.length?(i=e,h):i},h.cx=function(){return h.width()/2},h.cy=function(){return h.height()/2},h.buildArcs=function(){return d3.svg.arc().outerRadius(i).innerRadius(s)},h.drawSlices=function(e,t,i){return f=e.selectAll("g."+n).data(t(h.orderedGroup().top(Infinity))).enter().append("g").attr("class",function(e,t){return n+" "+t}),l=f.append("path").attr("fill",function(e,t){return r(t)}).attr("d",i),l.transition().duration(h.transitionDuration()).attrTween("d",m),l.on("click",y),f},h.drawLabels=function(e,t){c=e.append("text"),v(t),c.on("click",y)},h.hasFilter=function(){return t!=null},h.filter=function(e){return arguments.length?(t=e,h.dataAreSet()&&h.dimension().filter(t),e?h.turnOnReset():h.turnOffReset(),h):t},h.isSelectedSlice=function(e){return h.filter()==e.data.key},h.highlightFilter=function(){var e=1,t=3,r=.1,i=0;h.hasFilter()?h.selectAll("g."+n).select("path").each(function(n){h.isSelectedSlice(n)?d3.select(this).attr("fill-opacity",e).attr("stroke","#ccc").attr("stroke-width",t):d3.select(this).attr("fill-opacity",r).attr("stroke-width",i)}):h.selectAll("g."+n).selectAll("path").attr("fill-opacity",e).attr("stroke-width",i)},h.redraw=function(){h.highlightFilter();var e=a(h.orderedGroup().top(Infinity));return l=l.data(e),c=c.data(e),dc.transition(l,h.transitionDuration(),function(e){e.attrTween("d",m)}),v(u),h},h.label=function(e){return p=e,h},dc.registerChart(h),h.anchor(e)},dc.barChart=function(e){function m(){c.select("g.x").remove(),s.range([0,i.width()-i.margins().left-i.margins().right]),u=u.scale(s).orient("bottom"),c.append("g").attr("class","axis x").attr("transform","translate("+i.margins().left+","+M()+")").call(u)}function g(){c.select("g.y").remove(),o.domain([0,A()]).rangeRound([O(),0]),a=a.scale(o).orient("left").ticks(t),c.append("g").attr("class","axis y").attr("transform","translate("+i.margins().left+","+i.margins().top+")").call(a)}function y(){d.on("brushstart",b).on("brush",w).on("brushend",E);var e=c.append("g").attr("class","brush").attr("transform","translate("+i.margins().left+",0)").call(d.x(s));e.selectAll("rect").attr("height",M()),e.selectAll(".resize").append("path").attr("d",_),p&&k()}function b(e){}function w(e){var t=d.extent();v&&(t[0]=t.map(v)[0],t[1]=t.map(v)[1],c.select(".brush").call(d.extent(t))),i.filter([d.extent()[0],d.extent()[1]]),dc.redrawAll()}function E(e){}function S(){h=c.selectAll("rect.bar").data(i.group().all()),h.enter().append("rect").attr("class","bar").attr("x",function(e){return T(e)}).attr("y",M()).attr("width",function(){return x()}),dc.transition(h,i.transitionDuration()).attr("y",function(e){return N(e)}).attr("height",function(e){return C(e)}),dc.transition(h,i.transitionDuration()).attr("y",function(e){return N(e)}).attr("height",function(e){return C(e)}),dc.transition(h.exit(),i.transitionDuration()).attr("y",M()).attr("height",0)}function x(){var e=Math.floor(i.axisXLength()/l(s.domain()[0],s.domain()[1]).length);if(isNaN(e)||e<n)e=n;return e}function T(e){return s(e.key)+i.margins().left}function N(e){return i.margins().top+o(e.value)}function C(e){return O()-o(e.value)-r}function k(){p&&d.empty()&&d.extent(p);var e=c.select("g.brush");e.call(d.x(s)),e.selectAll("rect").attr("height",M()),L()}function L(){if(!d.empty()&&d.extent()!=null){var e=d.extent()[0],t=d.extent()[1];h.classed("deselected",function(n){return n.key<e||n.key>=t})}else h.classed("deselected",!1)}function A(){return i.group().orderNatural().top(1)[0].value}function O(){return i.height()-i.margins().top-i.margins().bottom}function M(){return i.height()-i.margins().bottom}function _(e){var t=+(e=="e"),n=t?1:-1,r=M()/3;return"M"+.5*n+","+r+"A6,6 0 0 "+t+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+t+" "+.5*n+","+2*r+"Z"+"M"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)}var t=5,n=1,r=1,i=dc.coordinateGridChart({}),s,o=d3.scale.linear().range([100,0]),u=d3.svg.axis(),a=d3.svg.axis(),f=!1,l=dc.units.integers,c,h,p,d=d3.svg.brush(),v;return i.transitionDuration(500),i.render=function(){return i.resetSvg(),i.dataAreSet()&&(c=i.generateSvg().append("g").attr("transform","translate("+i.margins().left+","+i.margins().top+")"),m(),g(),S(),y()),i},i.redraw=function(){return S(),k(),f&&g(),i},i.axisXLength=function(){return i.width()-i.margins().left-i.margins().right},i.filter=function(e){return e?(p=e,d.extent(e),i.dimension().filterRange(e),i.turnOnReset()):(p=null,d.clear(),i.dimension().filterAll(),i.turnOffReset()),i},i.x=function(e){return arguments.length?(s=e,i):s},i.y=function(e){return arguments.length?(o=e,i):o},i.xUnits=function(e){return arguments.length?(l=e,i):l},i.axisX=function(e){return arguments.length?(u=e,i):u},i.axisY=function(e){return arguments.length?(a=e,i):a},i.round=function(e){return arguments.length?(v=e,i):v},i.elasticAxisY=function(e){return arguments.length?(f=e,i):f},dc.registerChart(i),i.anchor(e)},dc.dataCount=function(e){var t=d3.format(",d"),n=dc.baseChart({});return n.render=function(){return n.selectAll(".total-count").text(t(n.dimension().size())),n.selectAll(".filter-count").text(t(n.group().value())),n},n.redraw=function(){return n.render()},dc.registerChart(n),n.anchor(e)},dc.dataTable=function(e){function u(){var e=t.root().selectAll("div.group").data(a(),function(e){return e.key});return e.enter().append("div").attr("class","group").append("span").attr("class","label").text(function(e){return e.key}),e.exit().remove(),e}function a(){o||(o=crossfilter.quicksort.by(i));var e=t.dimension().top(n);return d3.nest().key(t.group()).sortKeys(s).entries(o(e,0,e.length))}function f(e){var t=e.order().selectAll("div.row").data(function(e){return e.values}),n=t.enter().append("div").attr("class","row");for(var i=0;i<r.length;++i){var s=r[i];n.append("span").attr("class","column "+i).text(function(e){return s(e)})}return t.exit().remove(),t}var t=dc.baseChart({}),n=25,r=[],i=function(e){return e},s=d3.ascending,o;return t.render=function(){return t.selectAll("div.row").remove(),f(u()),t},t.redraw=function(){return t.render()},t.size=function(e){return arguments.length?(n=e,t):n},t.columns=function(e){return arguments.length?(r=e,t):r},t.sortBy=function(e){return arguments.length?(i=e,t):i},t.order=function(e){return arguments.length?(s=e,t):s},dc.registerChart(t),t.anchor(e)};