dc={version:"0.1.0",_charts:[]},dc.registerChart=function(e){dc._charts.push(e)},dc.hasChart=function(e){return dc._charts.indexOf(e)>=0},dc.deregisterAllCharts=function(){dc._charts=[]},dc.filterAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].filterAll()},dc.renderAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].render()},dc.redrawAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].redraw()},dc.baseMixin=function(e){var t,n,r,i,s=0,o=0;return e.dimension=function(n){return arguments.length?(t=n,e):t},e.group=function(t){return arguments.length?(n=t,e):n},e.filterAll=function(){return e.filter(null)},e.dataAreSet=function(){return t!=undefined&&n!=undefined},e.select=function(e){return i.select(e)},e.selectAll=function(e){return i.selectAll(e)},e.anchor=function(t){return arguments.length?(r=t,i=d3.select(r),e):r},e.root=function(t){return arguments.length?(i=t,e):i},e.width=function(t){return arguments.length?(s=t,e):s},e.height=function(t){return arguments.length?(o=t,e):o},e.resetSvg=function(){e.select("svg").remove()},e.generateSvg=function(){return e.root().append("svg").data([e.group().all()]).attr("width",e.width()).attr("height",e.height())},e},dc.pieChart=function(e){var t=null,n=t,r="pie-slice",i=d3.scale.category20c(),s=0,o=0,u=dc.baseMixin({});return u.render=function(){u.resetSvg();if(u.dataAreSet()){var e=u.generateSvg().append("g").attr("transform","translate("+u.cx()+","+u.cy()+")"),t=d3.layout.pie().value(function(e){return e.value}),n=u.buildArcs(),r=u.drawSlices(e,t,n);u.drawLabels(r,n),u.highlightFilter()}return u},u.innerRadius=function(e){return arguments.length?(o=e,u):o},u.colors=function(e){return arguments.length?(i=e,u):i},u.radius=function(e){return arguments.length?(s=e,u):s},u.cx=function(){return u.width()/2},u.cy=function(){return u.height()/2},u.buildArcs=function(){return d3.svg.arc().outerRadius(s).innerRadius(o)},u.drawSlices=function(e,t,n){var s=e.selectAll("g."+r).data(t).enter().append("g").attr("class",r);return s.append("path").attr("fill",function(e,t){return i(t)}).attr("d",n).on("click",function(e){u.filter(e.data.key),u.highlightFilter(),dc.redrawAll()}),s},u.drawLabels=function(e,t){e.append("text").attr("transform",function(e){e.innerRadius=0,e.outerRadius=s;var n=t.centroid(e);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(e){var t=e.data;return t.value==0?"":t.key})},u.hasFilter=function(){return n!=t},u.filter=function(e){return arguments.length?(n=e,u.dataAreSet()&&u.dimension().filter(n),u):n},u.isSelectedSlice=function(e){return u.filter()==e.data.key},u.highlightFilter=function(){u.hasFilter()&&u.selectAll("g."+r).select("path").each(function(e){u.isSelectedSlice(e)?d3.select(this).attr("fill-opacity",1).attr("stroke","#ccc").attr("stroke-width",3):d3.select(this).attr("fill-opacity",.1).attr("stroke-width",0)})},u.redraw=function(){return u.render()},dc.registerChart(u),u.anchor(e)},dc.barChart=function(e){function d(){c=l.selectAll("rect").data(r.group().all()),c.enter().append("rect").attr("class","bar").attr("x",function(e){return s(e.key)+i.left}).attr("y",function(e){return i.top+o(e.value)}).attr("width",function(){var e=Math.floor(r.width()/f(s.domain()[0],s.domain()[1]).length);if(isNaN(e)||e<n)e=n;return e}).attr("height",function(e){return g()-o(e.value)}),c.exit().remove()}function v(){p.extent(h);var e=l.select("g.brush");e.call(p.x(s)),e.selectAll("rect").attr("height",y())}function m(){return r.group().top(1)[0].value}function g(){return r.height()-i.top-i.bottom}function y(){return r.height()-i.bottom}function b(e){var t=+(e=="e"),n=t?1:-1,r=y()/3;return"M"+.5*n+","+r+"A6,6 0 0 "+t+" "+6.5*n+","+(r+6)+"V"+(2*r-6)+"A6,6 0 0 "+t+" "+.5*n+","+2*r+"Z"+"M"+2.5*n+","+(r+8)+"V"+(2*r-8)+"M"+4.5*n+","+(r+8)+"V"+(2*r-8)}var t=5,n=1,r=dc.baseMixin({}),i={top:10,right:50,bottom:30,left:20},s,o=d3.scale.linear().range([100,0]),u=d3.svg.axis(),a=d3.svg.axis(),f,l,c,h,p=d3.svg.brush();return r.render=function(){r.resetSvg();if(r.dataAreSet()){l=r.generateSvg().append("g").attr("transform","translate("+i.left+","+i.top+")"),s.rangeRound([0,r.width()-i.left-i.right]),u=u.scale(s).orient("bottom"),o.domain([0,m()]).rangeRound([g(),0]),a=a.scale(o).orient("left").ticks(t),d(),l.append("g").attr("class","axis x").attr("transform","translate("+i.left+","+y()+")").call(u),l.append("g").attr("class","axis y").attr("transform","translate("+i.left+","+i.top+")").call(a),p.on("brushstart",function(e){}).on("brush",function(e){r.filter([p.extent()[0],p.extent()[1]]),dc.redrawAll()}).on("brushend",function(){});var e=l.append("g").attr("class","brush").attr("transform","translate("+i.left+",0)").call(p.x(s));e.selectAll("rect").attr("height",y()),e.selectAll(".resize").append("path").attr("d",b),h&&v()}return r},r.redraw=function(){l.selectAll("rect").remove(),d(),v()},r.filter=function(e){return e?(h=e,p.extent(e),r.dimension().filterRange(e)):(h=null,p.clear(),r.dimension().filterAll()),r},r.margins=function(e){return arguments.length?(i=e,r):i},r.x=function(e){return arguments.length?(s=e,r):s},r.y=function(e){return arguments.length?(o=e,r):o},r.xUnits=function(e){return arguments.length?(f=e,r):f},r.axisX=function(e){return arguments.length?(u=e,r):u},r.axisY=function(e){return arguments.length?(a=e,r):a},dc.registerChart(r),r.anchor(e)};