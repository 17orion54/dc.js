dc={version:"0.1.0",_charts:[]},dc.registerChart=function(e){dc._charts.push(e)},dc.hasChart=function(e){return dc._charts.indexOf(e)>=0},dc.removeAllCharts=function(){dc._charts=[]},dc.filterAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].filterAll()},dc.renderAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].render()},dc.baseMixin=function(e){var t,n,r,i;return e.dimension=function(n){return arguments.length?(t=n,e):t},e.group=function(t){return arguments.length?(n=t,e):n},e.dataAreSet=function(){return t!=undefined&&n!=undefined},e.select=function(e){return i.select(e)},e.selectAll=function(e){return i.selectAll(e)},e.anchor=function(t){return arguments.length?(r=t,i=d3.select(r),e):r},e.root=function(t){return arguments.length?(i=t,e):i},e},dc.pieChart=function(e){var t=null,n="pie-slice",r=d3.scale.category20c(),i=0,s=0,o=0,u=0,a=t,f=dc.baseMixin({});return f.render=function(){f.select("svg").remove();if(f.dataAreSet()){var e=f.generateTopLevelG(),t=d3.layout.pie().value(function(e){return e.value}),n=f.buildArcs(),r=f.drawSlices(e,t,n);f.drawLabels(r,n),f.highlightFilter()}},f.innerRadius=function(e){return arguments.length?(u=e,f):u},f.colors=function(e){return arguments.length?(r=e,f):r},f.filter=function(e){return f.dimension().filter(e),f},f.width=function(e){return arguments.length?(i=e,f):i},f.height=function(e){return arguments.length?(s=e,f):s},f.radius=function(e){return arguments.length?(o=e,f):o},f.filter=function(e){return arguments.length?(a=e,f.highlightFilter(),f.dataAreSet()&&f.dimension().filter(a),f):a},f.filterAll=function(){return f.filter(t)},f.hasFilter=function(){return a!=t},f.generateTopLevelG=function(){return f.root().append("svg").data([f.group().all()]).attr("width",i).attr("height",s).append("g").attr("transform","translate("+f.cx()+","+f.cy()+")")},f.cx=function(){return i/2},f.cy=function(){return s/2},f.buildArcs=function(){return d3.svg.arc().outerRadius(o).innerRadius(u)},f.drawSlices=function(e,t,i){var s=e.selectAll("g."+n).data(t).enter().append("g").attr("class",n);return s.append("path").attr("fill",function(e,t){return r(t)}).attr("d",i).on("click",function(e){f.filter(e.data.key),dc.renderAll()}),s},f.drawLabels=function(e,t){e.append("text").attr("transform",function(e){e.innerRadius=0,e.outerRadius=o;var n=t.centroid(e);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(e){var t=e.data;return t.value==0?"":t.key})},f.isSelectedSlice=function(e){return a==e.data.key},f.highlightFilter=function(){a&&f.selectAll("g."+n).select("path").each(function(e){f.isSelectedSlice(e)?d3.select(this).attr("fill-opacity",1).attr("stroke","#ccc").attr("stroke-width",3):d3.select(this).attr("fill-opacity",.1).attr("stroke-width",0)})},dc.registerChart(f),f.anchor(e)};