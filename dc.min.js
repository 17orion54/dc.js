dc={version:"0.1.0",_charts:[]},dc.registerChart=function(e){dc._charts.push(e)},dc.hasChart=function(e){return dc._charts.indexOf(e)>=0},dc.removeAllCharts=function(){dc._charts=[]},dc.filterAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].filterAll()},dc.renderAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].render()},dc.base=function(e){var t;return e.dimension=function(n){return arguments.length?(t=n,e):t},e},dc.pieChart=function(e){var t=null,n="pie-slice",r,i,s=d3.scale.category20c(),o,u=0,a=0,f=0,l=0,c=t,h={},p=dc.base(h);return h.render=function(){i.select("svg").remove();if(h.dataAreSet()){var e=h.generateTopLevelG(),t=d3.layout.pie().value(function(e){return e.value}),n=h.buildArcs(),r=h.drawSlices(e,t,n);h.drawLabels(r,n),h.highlightFilter()}},h.select=function(e){return i.select(e)},h.selectAll=function(e){return i.selectAll(e)},h.anchor=function(e){return arguments.length?(r=e,i=d3.select(r),h):r},h.innerRadius=function(e){return arguments.length?(l=e,h):l},h.colors=function(e){return arguments.length?(s=e,h):s},h.group=function(e){return arguments.length?(o=e,h):o},h.filter=function(e){return h.dimension().filter(e),h},h.width=function(e){return arguments.length?(u=e,h):u},h.height=function(e){return arguments.length?(a=e,h):a},h.radius=function(e){return arguments.length?(f=e,h):f},h.filter=function(e){return arguments.length?(c=e,h.highlightFilter(),h.dataAreSet()&&h.dimension().filter(c),h):c},h.filterAll=function(){return h.filter(t)},h.hasFilter=function(){return c!=t},h.generateTopLevelG=function(){return i.append("svg").data([o.all()]).attr("width",u).attr("height",a).append("g").attr("transform","translate("+h.cx()+","+h.cy()+")")},h.cx=function(){return u/2},h.cy=function(){return a/2},h.buildArcs=function(){return d3.svg.arc().outerRadius(f).innerRadius(l)},h.drawSlices=function(e,t,r){var i=e.selectAll("g."+n).data(t).enter().append("g").attr("class",n);return i.append("path").attr("fill",function(e,t){return s(t)}).attr("d",r).on("click",function(e){h.filter(e.data.key),dc.renderAll()}),i},h.drawLabels=function(e,t){e.append("text").attr("transform",function(e){e.innerRadius=0,e.outerRadius=f;var n=t.centroid(e);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(e){var t=e.data;return t.value==0?"":t.key})},h.isSelectedSlice=function(e){return c==e.data.key},h.highlightFilter=function(){c&&i.selectAll("g."+n).select("path").each(function(e){h.isSelectedSlice(e)?d3.select(this).attr("fill-opacity",1).attr("stroke","#ccc").attr("stroke-width",3):d3.select(this).attr("fill-opacity",.1).attr("stroke-width",0)})},h.dataAreSet=function(){return h.dimension()!=undefined&&o!=undefined},dc.registerChart(h),h.anchor(e)};