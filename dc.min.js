dc={version:"0.1.0",_charts:[]},dc.registerChart=function(e){dc._charts.push(e)},dc.hasChart=function(e){return dc._charts.indexOf(e)>=0},dc.removeAllCharts=function(){dc._charts=[]},dc.filterAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].filterAll()},dc.renderAll=function(){for(var e=0;e<dc._charts.length;++e)dc._charts[e].render()},dc.baseMixin=function(e){var t=null,n,r,i=t,s,o;return e.dimension=function(t){return arguments.length?(n=t,e):n},e.group=function(t){return arguments.length?(r=t,e):r},e.filter=function(t){return arguments.length?(i=t,e.dataAreSet()&&e.dimension().filter(i),e):i},e.filterAll=function(){return e.filter(t)},e.hasFilter=function(){return i!=t},e.dataAreSet=function(){return n!=undefined&&r!=undefined},e.select=function(e){return o.select(e)},e.selectAll=function(e){return o.selectAll(e)},e.anchor=function(t){return arguments.length?(s=t,o=d3.select(s),e):s},e.root=function(t){return arguments.length?(o=t,e):o},e},dc.pieChart=function(e){var t="pie-slice",n=d3.scale.category20c(),r=0,i=0,s=0,o=0,u=dc.baseMixin({});return u.render=function(){u.select("svg").remove();if(u.dataAreSet()){var e=u.generateTopLevelG(),t=d3.layout.pie().value(function(e){return e.value}),n=u.buildArcs(),r=u.drawSlices(e,t,n);u.drawLabels(r,n),u.highlightFilter()}},u.innerRadius=function(e){return arguments.length?(o=e,u):o},u.colors=function(e){return arguments.length?(n=e,u):n},u.width=function(e){return arguments.length?(r=e,u):r},u.height=function(e){return arguments.length?(i=e,u):i},u.radius=function(e){return arguments.length?(s=e,u):s},u.generateTopLevelG=function(){return u.root().append("svg").data([u.group().all()]).attr("width",r).attr("height",i).append("g").attr("transform","translate("+u.cx()+","+u.cy()+")")},u.cx=function(){return r/2},u.cy=function(){return i/2},u.buildArcs=function(){return d3.svg.arc().outerRadius(s).innerRadius(o)},u.drawSlices=function(e,r,i){var s=e.selectAll("g."+t).data(r).enter().append("g").attr("class",t);return s.append("path").attr("fill",function(e,t){return n(t)}).attr("d",i).on("click",function(e){u.filter(e.data.key),u.highlightFilter(),dc.renderAll()}),s},u.drawLabels=function(e,t){e.append("text").attr("transform",function(e){e.innerRadius=0,e.outerRadius=s;var n=t.centroid(e);return isNaN(n[0])||isNaN(n[1])?"translate(0,0)":"translate("+n+")"}).attr("text-anchor","middle").text(function(e){var t=e.data;return t.value==0?"":t.key})},u.isSelectedSlice=function(e){return u.filter()==e.data.key},u.highlightFilter=function(){u.hasFilter()&&u.selectAll("g."+t).select("path").each(function(e){u.isSelectedSlice(e)?d3.select(this).attr("fill-opacity",1).attr("stroke","#ccc").attr("stroke-width",3):d3.select(this).attr("fill-opacity",.1).attr("stroke-width",0)})},dc.registerChart(u),u.anchor(e)};